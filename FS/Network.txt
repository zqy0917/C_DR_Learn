
第一章  概述
1: 什么是网络协议，三要素是什么？
答：为进行网络数据交换而建立的规则、约定称为网络协议。三要素，语法(数据格式)、语义(做什么响应，什么操作)、同步(事件的实现顺序)

2: TCP/IP 5层协议：物理层、数据链路层、网络层、运输层、应用层；OSI标准7层：会话层、表示层、应用层

3: ”网络好慢“通常什么导致的？
答：网络总时延＝发送时延(主机或者路由器发送数据到信道的时间，和带宽 bit/s 有关)＋传播时延(电磁波在信道中传播的时间)＋处理时延(主机或者路由器收到分组时需要拆包、分析首部等时间)＋排队时延(分组传输中要经过很多路由器，在每一个路由器中的输入输出都需要排队，需要查找路由表和转发表等)

4: 分组交换有哪些优点？
答：高效(在分组传输的过程中动态分配传输带宽，对通信链路逐段占用)、灵活（为每个分组独立地选择最合适的转发路由）、迅速（以分组作为传送单位，可以先不建立连接就能向其他主机发送分组）、可靠（可靠的网络协议）

第二章  物理层
1: 调制通常有哪些方式？
答：基带调制或者说是编码，是将数字信号转换成另一种数字信号；另一类使用载波调制，称为带通调制，是将数字信号转换成模拟信号。
编码常用的有：不归零制、归零制、曼彻斯特、差分曼彻斯特。带通调制方法：调幅、调频、调相。

2: 传输媒介分成哪几类？
答：导引型传输媒介(铜线、光纤)和非导引型传输媒介(无线电、电磁波、微波)。

3: 信道复用技术解决什么问题？都哪几种信道复用技术？
答：解决信道复用的问题，节省经济成本。1，频分复用技术，采用复用器和分用器，不同的用户使用同一信道，但是使用不同的频带。
2，波分复用，使用于光纤传输场景。原理是对光进行调制解调，将波长变换到不同的长度，从而达到增加复用率。
3，码分复用。


第三章  数据链路层
1: 数据链路层做了哪些事儿？
答：1，将网络层传递下来的IP分组加上首部和尾部用来定界，封装成帧；2，将和帧定界控制一样的字符进行转义，从而实现透明传输；3，差错检测(CRC检验)

2: 数据链路层怎样进行的差错检测？
答：差错分为比特差错和传输差错。对于比特差错通常采用CRC检验法，在帧后面加上经过模2运算计算出来的冗余码。接受端通过同样的模2运算后根据余数确定是否有差错。
常见的传输差错有帧丢失、帧重复、帧失序。因此在CRC检验的基础上增加了帧编号、确认和重传机制。

3: 什么是PPP协议？
答：是一种应用在数据链路层的点对点协议。有3个组成部分：1，将IP数据报封装到串行链路的方法；2，一个用来建立、配置和测试数据链路连接的链路控制协议LCP；3，一套网络控制协议NCP。

4: PPP工作流程
答：1，调制解调器向路由器发送载波，建立起物理连接；2，发送LCP类型的PPP协议，建立起LCP链路，并进行LCP协商(检测是否可以进行通信)；3，发送 NCP 模式PPP协议，进行NCP配置协商。如果在PPP链路上运行的是IP协议，则对PPP链路的每一端配置IP协议模块，用到的协议为IPCP协议。

5: 什么是局域网？
答：网络为一个单位所拥有，且地理范围和站点数目均有限。具有广播功能，也称为以太网。可按照拓扑结构分类，星型网、环形网、总线网。以太网发送的数据都是采用曼彻斯特编码的信号。
适配器（网卡）的作用：负责将数据传输到以太网或者应该在存储器的哪个位置上将以太网接收到的数据存起来。而网络上的数据率和 IO 总线上的数据率不同，因此适配器中应该包含一个输入输出缓存。现在的适配器一般都含有调制解调器，即包含了物理层和数据链路层的功能。

6: 为了防止局域网上的多个主机同时传输数据而发生碰撞，以太网采用 CSMA/CD 协议。CSMA/CD 协议具有多点接入、载波监听、碰撞监测三个特点。多点接入指允许多个主机连接到总线上；载波监听指在发送前和发送中都不停的检测信道，信道空闲才发送，否则分组一直缓存在适配器缓存中；碰撞检测指“边发送边监听”，检测到碰撞时立刻停止发送，并各自等待一个随机数的时间再次发送，也称为截断二进制指数退避。

7: 怎么提升以太网的信道利用率？
答：1，限制以太网的连线长度；2，控制以太网的帧长不能太短

8: 以太网 MAC 帧格式，帧起始符号、目的地址、源地址、IP数据报、FCS。以太网中数据传输多使用 MAC 帧。

9: 什么是交换机？
答：交换机实质是一个多接口网桥，每个接口都直接与一个单台主机或另外一台交换机相连，相互通信的主机都独占媒体，无碰撞地传输。交换机有自学习功能，会缓存主机的mac地址。

10: 虚拟局域网怎么实现的？
答：在MAC帧中增加4字节的VLAN标记，只有相同VLAN标示相同的才会接受帧，否则丢弃。

11: 单工，半双工和全双工有何区别和联系？
答：单工数据传输只支持数据在一个方向上传输；在同一时间只有一方能接受或发送信息，不能实现双向通信，举例：电视，广播。
半双工数据传输允许数据在两个方向上传输,但是,在某一时刻,只允许数据在一个方向上传输,它实际上是一种切换方向的单工通信；在同一时间只可以有一方接受或发送信息，可以实现双向通信。举例：对讲机。
全双工数据通信允许数据同时在两个方向上传输,因此,全双工通信是两个单工通信方式的结合,它要求发送设备和接收设备都有独立的接收和发送能力；在同一时间可以同时接受和发送信息，实现双向通信，举例：电话通信。

12: PPP帧与MAC帧区别：
ppp属于广域网范畴，MAC是局域网范畴，按实际情况和环境就选用不同的协议，ppp支持的网络结构只能是点对点，mac支持多点对多点。
以太网中用mac，远程的话就用ppp（如ADSL拨号，就是基于ppp的）。
ppp是点到点协议  ,逻辑上相连的就一台设备，因此不需要寻址, 目标地址为广播地址, PPP中前6个字节就是目标地址。


第四章  网络层(重点章节)
网络层提供的数据报服务的特点：
1，面向无连接；2，不保证可靠性；
3，到达终点的时间不一定按发送顺序；4，不负责流量控制差错检测等；
5，只将分组发到线路上，由系统自主选定路线进行传输。

2: IP 地址由网络号和主机号构成。是给因特网上的每一个主机或路由器的每一个接口分配一个在全世界范围是唯一的32位的标识符。IP地址的结构使我们可以在因特网上很方便地进行寻址。

3: A、B、C三类 IP 地址分别是 0、10、110开头代表的是一对一通信，其中网络号分别为前1，2，3字节。D和E分别是1110和1111开头代表的是多播。

4: IP 地址和硬件地址区别？
答：IP 地址属于网络层的逻辑地址，是通过软件实现的。而硬件地址是物理地址在数据链路层和物理层使用。两端IP地址在IP分组的首部，两端的硬件地址则在MAC帧的首部。

5: 什么是ARP协议？起什么作用？跨网怎样工作？
答：地址解析协议。已知主机的IP地址，寻找其MAC地址的协议。ARP只解决同一个局域网内的IP－MAC映射问题，如果跨网络且ARP表中没有缓存，则需要发送ARP请求，局域网内的路由器收到ARP请求后，知道该目地地址所在网段（有路由表）可达，开启了ARP代理，告诉主机目标地址写我的就好。

6: IP 数据报分组转发的步骤：
(1)从数据报的首部提取出源地址和目标地址D，得出目标网络地址为N，如果D就是与此路由器相连的某个IP，则直接交付(找到目标的物理地址封装成MAC帧，转发)。
(2)查找路由表中是否有目的地址就是D的特定主机路由，有则转发；否则跳转到(3)
(3)若路由表中有到达网络为N的路由，则转发到下一跳；否则执行(4)
(4)若路由表中有一个默认路由，则转发到默认路由；否则报错，转发分组出错。

7: 为什么要划分子网？
答：1，给每一个主机都分配一个网络号会使路由表过大影响性能；2，两级IP地址不够灵活。
注：划分子网只是把IP地址的主机号这部分进行再划分，而不改变IP地址原来的网络号

8: 子网掩码定义：子网掩码是一个32位地址，用于屏蔽IP地址的一部分，用以区别网络号和主机号，并说明该IP地址是在局域网上，还是在远程网上。
子网掩码与IP地址是组合使用的，IP地址我们都知道是计算机在网络内的唯一标识，而子网掩码顾名思义是用于划分子网的。

9: 使用子网时分组转发流程：
(1)从数据报中提取目的IP地址 D 
(2)将D和源主机子网掩码按位与，得到的网络地址和源主机的一致则直接交付(ARP协议获取物理地址，再封装成MAC帧，通过路由器或者交换机转发到目的地址)，否则跳转(3)
(3)查找路由表，路由表中有目的地址为 D 的主机路由则传送到指定的下一跳，否则(4)
(4)对路由表逐行检查，用子网掩码与D按位与，如果和表中的目的网络地址匹配，则找到，转发到指定的下一跳，否则(5)
(5)若路由表中有默认路由，则转发给默认路由，否则(6)
(6)报告转发分组失败

10: CIDR(Classless Inter-Domain Rounting) 解决什么问题？
答：IPv4 快用尽，互联网主干网上的路由器的路由表数量过大，B类地址已经分配近一半。CIDR 采用原来的网络前缀＋主机号的形式，并且在最后以‘／’标明主机号所占位数。其子网掩码 1 的位数和主机号位数一样，其他都为 0。CIDR 起到了地址聚合的作用，简化了路由表的查找。网络前缀位数越少，其地址块包含的地址数越多。

11: CIDR 的最长前缀匹配
由于CIDR有地址聚合的功能，所以查找路由表时可能会遇到目的地址和多个掩码相与后匹配，此时应当选位数最大的那个，因为网络号位数越大，地址块越小，查找越精确。

12: 使用 CIDR 后，由于要寻找最长前缀匹配，使路由表的查找过程变得更加复杂，通常将无分类编制的路由表存放成二查线索树，便于查找。

13: ICMP(Internet Control Message Protocol) 协议作用？网际控制报文协议，由 类型＋代码＋检验和＋ICMP数据组成。
答：差错报告报文和询问报文。其中差错报文细分为：终点不可达(发送不能交付的数据报)、时间超时(TTL为0，返回给源主机)、参数问题(数据报中首部值不正确)、改变路由(重定向)
查询报文细分为：发送请求和回答、时间戳请求和回答。例如：PING 使用了发送请求和回答报文，没有通过运输层测试两台主机之间的连通性。

14: 路由选择协议分为两大类：内部网关协议(IGP)，外部网关协议(EGP)。其中内部网关协议应用于一个自治系统（AS）内部，而外部网关协议应用于自治系统之间的路由选择。

15: 什么是 RIP 协议？该协议有什么特点？Routing Information Protocol
答：RIP 协议是内部网关协议的中应用最广泛的协议。
特点：1，仅和相邻路由器交换信息；
2，路由器交换的信息是当前本路由器所知道的全部信息，即自己现在的路由表；
3，按固定的时间间隔交换路由信息。RIP 协议使用距离向量算法。

16: OSPF（Open Shortest Path First）和RIP（Routing Information Protocol）的区别：
1，OSPF使用“洪泛法”向本自治系统内的所有路由器发送信息，一传百，百传千的方式。而RIP仅仅向相邻路由发送；
2，发送的信息只是部分信息，相邻链路以及代价(距离、费用、带宽等)；
3，只有当链路状态发生变化时才会发送信息，而非像RIP一样定时发信息。
OSPF使用层次区域划分，将一个自治区域划分成若干个更小的范围，这样可以限制“洪泛法”只局限于一个区域而不是整个非常大的自治系统。连接每个小区域的路由器叫做区域边界路由器，上层的主干区域中连接自治系统外的其它自治系统的路由器称为自治系统边界路由器。

17: OSPF 的分组类型：1，问候分组, 用来发现和维持邻站的可达性；2，数据库描述分组，向邻站发送自己的链路状态数据库摘要信息；3，链路状态请求分组，向对方请求发送某些链路状态的详细信息；4，链路状态更新分组，用洪泛法对全网更新链路状态；5，链路状态确认，对链路更新分组的ACK。有该分组的存在才保证 OSPF 使用的是可靠的洪泛法。

18: OSPF 的核心是保证每个路由器中的链路状态数据库内容一致(相邻的路由器10秒钟发送一次问候分组，并且30分钟刷新一次数据库中的链路状态)，从而可以计算出相同的最小代价的路径(如Dijkstra的最短路径算法)。

19: 外部路由协议 BGP 工作原理？
答：BGP 力求找到一条最佳路由，该策略可能涉及到多方面因素(政治、安全、经济、可达性等)。在配置BGP时，每一个 AS(自治系统) 的管理员至少选择一个路由器作为该 AS 的“BGP发言人”，该发言人一般来说是 AS 边界路由器。BGP 工作依赖可靠的服务，因此两个发言人需要建立 TCP 连接，建立连接后两个发言人也叫“对等站”。两个对等站之间互相交换路由信息，形成网络拓扑结构，从而各 BGP 发言人可以采用各自的策略找到到达目标路由的最佳路径。

20: BGP 四种报文作用？
答：BGP 四种报文：1，OPEN 打开报文(用来与相邻的另一个发言人建立关系)；2，UPDATE 报文(用来通告某一路由信息，或者是撤消的路由)；3，KEEPALLIVE  保活报文 (周期性的证实邻站的连通性)；4，NOTIFICATION 通知报文 (用来发送检测到的差错)。

21: 路由器划分为路由选择部分和分组转发部分。路由选择部分由路由选择处理机和路由表构成；分组转发部分由交换结构、一组输入端口、一组输出端口组成。

22: 路由表和转发表的区别与联系？
答：二者区别在于，路由表通常存放的是，目标地址，掩码，下一跳地址。而转发表则存放更加具体的信息，如端口，MAC地址等。路由表更为抽象和复杂，转发表更为具体和简单。
二者联系：转发表实际上是由路由表生成的，它们都是转发报文的一组规则集，转发表功能更加类似于交换机，在以太网中可以清晰的表述其功能。

23: IPv6 相比 IPv4 主要变化有哪些？
答：1，更大的地址空间，IPv6 增大到128位；2，灵活的首部格式；3，改进的选项，增加有效载荷；4，支持自动配置(不需要使用 DHCP)；5，取消了数据校验；6，数据报的目的地址增加任播类型，即终点是一组计算机，传递给任意一个都可以。

24: 目前两种 IPv4 向 IPv6 过渡的方法是什么？
答：1，双协议栈方法，该方法是指在一部分主机或路由器内装两个协议栈，一个 IPv4，一个 IPv6。但是，当一个 IPv6 的数据报进入 IPv4 网络时，则需要进行首部转换，即将 IPv6 的首部转换成 IPv4 的首部，到达支持 IPv6 的路由器后在转回来，该方法会导致一些首部信息丢失(例如：IPv6 中的流标号)。
2，隧道技术，即当一个 IPv6 的数据报进入 IPv4 网络时，将 IPv6 整个数据报放到 IPv4 的数据部分，看起来就像在 IPv4 网络中开辟一个隧道一样。为了 IPv4 数据报知道自己的数据部分是一个 IPv6 数据报，需要将 IPv4 首部的协议字段置成 41。

25: 什么是IP多播？
答：在互联网上进行一对多的多播就属于IP多播，IP多播需要使用多播 IP 地址即 D 类 IP 地址。

26: 什么是 IGMP 协议？有何作用？
答：IGMP(Internet group management protocol)网际组管理协议。该协议用来维护局域网内的多播组成员的加入、退出的协议。

27: 本地地址和全球地址的区别？
答：对于一些仅在本机构内部使用的计算机。由机构自行分配的、仅在本机构有效的IP地址称为本地地址；全球地址，即全球唯一的IP地址。常见的本地址有：192.168.XXX;172.16.XXX

28: VPN 分成哪几类？
答：按VPN的应用分类：
（1）Access VPN（远程接入VPN）：客户端到网关，使用公网作为骨干网在设备之间传输VPN数据流量；
（2）Intranet VPN（内联网VPN）：网关到网关，通过公司的网络架构连接来自同公司的资源；
（3）Extranet VPN（外联网VPN）：与合作伙伴企业网构成Extranet，将一个公司与另一个公司的资源进行连接。

28: VPN 工作原理？
答：如果某个公司路由器发现某主机要访问的目的地址不再本机构内，而在其他分机构或者总机构，则需要将机构内部的数据报进行加密。然后外层再次加上数据报的首部，封装成可以在互联网上传送的外部数据报(源／目的地址均为互联网上的路由器地址)。当目的路由器收到外部数据报时将其内数据报提取并解密，找到对应的本机构目的地址，然后转发即可。这个过程就像在两台主机之间开辟了专用线路一样，其实是虚拟的。

29: 在一个使用本地IP地址的专用网内部主机，想要跟外网上的主机通信时，需要借助网络地址转换技术实现，即装有 NAT 软件的路由器(该路由器至少需要有一个全球IP地址)。网络地址转换 NAT 的工作原理？
答：假设 192.168.0.100 内部IP主机 A 向一个 100.16.133.2 的外部主机 B 发数据报，然后 B 给 A 回一个数据报。使用 NAT 路由器 C 的实现如下：
（1）A 将数据报发给 C，C 检测到目标地址是一个外部地址，则将将数据报中的源地址转换成 C 的全球 IP 地址然后转发出去，发送给 B。
（2）B 收到数据报后发现目的地址是 C 的全球 IP地址，则给该地址回一个新数据报，C 收到该数据报后，通过本地的 NAT 地址转换表找到真正的源主机是 A 于是发给A。
（3）在上述过程的基础上将 NAT 地址转换表添加端口号的转换，则可以实现一个 NAT 路由器对应多个内部主机同时跟外界通信。


第六章  运输层(重点章节)
1: 网络层和运输层的区别与联系？
答：网络层为主机之间提供逻辑通信，面向无连接。而运输层为应用进程之间提供端到端的逻辑通信，面向连接/无连接；运输层的工作需要依赖网络层。

2: TCP 与 UDP 的区别？常用的使用上述两种传输层的应用协议有哪些？
答：TCP 面向连接，在传输数据之前必须建立可靠的连接，不提供广播或者多播服务。UDP 面向无连接，对方收到UDP报文后不需要给出确认。
UDP：DNS、DHCP、TFTP、RIP、IGMP
TCP：SMTP、TELNET、HTTP(s)、FTP

3: 什么是端口？端口作用是什么？
答：运输层需要完成复用和分用两大功能，即一个主机的多个进程与另一个主机的多个进程之间的通信，在发送端多个进程需要将数据报统一交给运输层(复用)，而接收端的运输层需要将多个数据报分发给对应的目标进程(分用)。为了完成上述功能则需要为每个主机的端口设置一个标识符，该标识就是协议端口号，简称端口。

4: UDP 协议的主要特点：
（1）面向无连接，减少了开销和发送数据的时间延。
（2）尽最大努力交付，即不保证可靠交付，因此主机不需要维持复杂的连接状态表。
（3）UDP 面向报文，发送方的 UDP 将应用层交下来的报文添加上首部后直接交付给 IP 层，不作任何处理。因此 UDP 报文长度不宜过长，否则会导致 IP 层进行大量分片，降低 IP 层效率。反之，若报文过短，UDP 交给 IP 层之后会使 IP 层首部相对长度太大，也会降低 IP 层效率。
（4）UDP 没有拥塞控制，即网络出现拥塞不会使源主机的发送速率降低，并且允许网络拥塞时丢失部分数据，适用于实时场景(实时音视频等)。
（5）UDP 支持一对一、一对多、多对一、多对多通信。
（6）UDP 首部开销小，只有8字节：源端口、目的端口、长度、检验和(类似于 IP 协议的检验和，经过反码求和运算得出的，区别是 UDP 对首部和数据都做检验，接收方发现有错则丢弃)

5: 传输控制协议 TCP 的主要特点有哪些？
答：1，面向连接的传输层协议(逻辑连接，是协议软件所提供的一种抽象)；
2，每一条连接只能有两个端点,即一对套接字: IP:Port ；
3，TCP 提供可靠交付的服务，无差错、不丢失、不重复、不乱序；
4，TCP 提供全双工通信；
5，面向字节流，即将应用层传递下来的数据转成字节流，不关心具体数据的内容。

6: ARQ(Automation Repeat reQuest)协议, 和 连续ARQ 协议的工作原理？
答：设现在有 TCP 报文段 a1～a20 编号为 1～20，需要从 主机A 发送到 服务器B。
ARQ 规定每次只能发送一个报文段，在收到该报文段的确认时候才能发送下一个，如果在超时时间内没有收到确认，则视为丢失，A 会重发该报文段。因此 A 在发完一个报文段后必须暂时保存已发送的报文段等待确认。ARQ 协议简单但是信道利用率比较低。
连续ARQ 协议为了提高信道利用率，采用流水线传输的方式，即位于发送窗口的 n(假定为5) 个报文段都可以连续发送出去，而不必一次发送一个，发送窗口从报文序号 1～5 开始。连续ARQ 规定发送方每收到一个确认，就把发送窗口向前滑动一个位置。

7: TCP 首部中的序号和确认号意义是什么？
答：在TCP报文段中每个字节都是按序号编号。序号值代表的是该报文段中所发送的数据的第一个字节的序号。确认号是指期望收到对方下一个报文段的第一个数据字节的序号。
例如：A给B发送一段数据报，起始序号是 300，数据长度为400，则A在发送报文的首部中的序号为 300。B正确收到该报文段，序号字段是300，数据长度为 400(序号300～700)。因此 B 期望收到 A 的下一个数据序号是 701，于是 B 发送给 A的确认报文中确认号为 701。

8: TCP 首部中的窗口字段(占2字节)含义？
答：该字段是指发送本报文段的一方的接收窗口。是数据的接收方告诉发送方，从本报文段的首部中的确认号算起，接收方目前允许对方发送的数据量(因为接收方数据缓存空间有限)。

9: 规定最大报文段长度 MSS(Maximum Segment Size) 的意义以及双方如何确定 MSS？
答：如果 MSS 太小则会导致 数据大小／（IP 数据报首部＋TCP首部）的值太小，这样会降低网络利用率。反过来如果太大会导致 TCP 数据报在 IP 层进行分片，到达终点时还需要 IP 层进行组装返回给 TCP 层，这些也会使开销增大。因此 MSS 应该尽可能大些，只要保证在 IP 层不被分片即可，而事实上数据可能在不同的信道上传输，而各个信道的 MTU(Maximum Transmission Unit) 可能会相差很大，难免导致 IP 分组分片传送。所以最佳 MSS 的选择很难确定，在建立 TCP 连接时，双方都把自己能够支持的 MSS 写入这一字段，以后按照这个数值传递数据。若主机未填写则默认 536。

10: 时间戳选项(10字节，包含时间戳值和时间戳回送回答值)，用来计算往返时 RTT, 发送方在发送报文段时将当前时钟时间戳写入，接收方在确认该报文段时把时间戳字段值复制到时间戳回送回答字段。因此发送方在收到确认报文后，可以准确的计算出 RTT。

11: TCP 滑动窗口机制实现流程？
答：TCP 发送窗口由前沿、后沿以及三个描述发送状态的指针 p1、p2、p3 构成。其中 p1~p2 表示已发送但未收到确认的数据段，p2～p3 表示允许发送但尚未发送的数据段。每次发送方收到确认后，根据确认号和窗口，调整前沿、后沿以及 p2 的位置。同理，接收方发送完确认后，也会调整自己的前后沿(前移)。

12: TCP 发送缓存和接受缓存的作用？
答：设 A 向 B 发送编号为 10～20 这 10 个字节的数据。A 的发送缓存会存放 10～20 以及 20 后面的一部分数据(缓存空间有限)，并等待 B 的确认，收到确认后 A 的发送缓存中会删除 10～20，并且添加新的数据。B 的接收缓存中会存储：（1）按序到达但尚未被应用程序读取的数据(如：10～20 按序到达)；（2）未按序到达等待拼接的数据(如：5、6、7线到达，需要缓存起来等待其他数据)。

13: 超时重传时间 RTO 怎样选择？
答：当发送端等待接收端的确认报文时会自动开启一个计时器，如果计时器超过了 RTO 则视为发送失败，重传数据。因此 RTO 大小的选择至关重要，太大使网络空闲时间增大，降低传输效率，太小可能会造成频繁重传，使网络负荷增大。RTO 通过每次对新的 RTT 样本的迭代得出(还需要使用三个公式)。

14: SACK 选择确认用来解决什么问题？
答：假设：B 接收窗口中，收到的数据端为 1～1000，1500～3000。即 1001～1499 中间的数据丢失，如果按照以往的逻辑，此时 B 需要给 A 发送的确认报文中，确认号为1001，也就是说 A 收到确认报文后需要将 1001～3000 的报文重传。这很显然浪费了很多网络资源。为了解决这个问题 RFC2018 标准引入了 SACK 选项，即 B 可以向 A 发送两个边界(1500,3000)，则 A 会只发送丢失的部分(1001～1499)。

15: TCP 的流量控制实现方式？
答：流量控制就是让发送方的发送速率不要太快，要让接收方来得及收(接收方TCP缓存大小有限)。利用滑动窗口机制可以很方便的在 TCP 连接上实现流量控制。因为每次 B 的确认报文中都会有当前允许发送的窗口大小，A 不允许发送超过该数值的数据报。需要注意的是，在 A 每次收到零窗口确认时都需要开启一个持续计时器，时间到期会向 B 发送一个探测报文(仅1字节)，B 在确认这个报文时给出现在的窗口值，如果还是零则传零。该方法可以避免 B 发送新的非零确认窗口丢失导致的死锁问题。

16: 什么是网络拥塞？
答：若对网络中的某一资源的需求超过了该资源所能提供的可用部分，网络的性能就要变坏，这种情况就叫拥塞。比如：当前网络带宽 100M/s, 此时一个服务器以1G／s 的速率向某台主机发数据，此时就会导致网络拥塞，需要让服务端发送速率慢一些。

17: TCP 进行拥塞控制的四种算法：慢开始、拥塞避免、快重传、快恢复，如果出现了分组超时则认为是网络拥塞。
拥塞控制主要由发送端来控制，出现拥塞的征兆就是分组超时频率增加。因此发送方要维持一个叫做拥塞窗口的状态变量。该变量会动态变化，大小取决于网络情况。
慢开始：指的是初始时，拥塞窗口的大小逐渐增加，由小到大逐渐成倍的增加。
拥塞避免：当使用慢开始算法使得拥塞窗口增大到一定的门限值时，采用该算法进行线性的增长，不至于导致网络突然拥塞，即更缓慢的增长。
快重传：为了避免当网络没拥塞，只是个别报文丢失，而让发送端误以为出现拥塞。采取快重传算法，该算法要求发送方立即对中间没收到的报文发送确认，而不是等待该报文，例如：收到1，2号，但是没收到 3 号，接着又收到 5，6号，此时接受端需要向发送端发三个2号的确认报文，此时发送端知道并没有拥塞，确实丢失了 3 号，重传即可。
快恢复就是上述的过程立刻进行 3 号数据重传，并调整门限值处以2。
注：发送方窗口的上限值需要综合考虑接受端的接受窗口和发送端的拥塞窗口。即取二者的最小值。
当接受端的接受窗口比较小时，代表传输速率收到接受方的接受能力限制。也就是流量控制。
当发送端的拥塞窗口比较小时，代表传输速率受到当前网络拥塞的限制。也就是拥塞控制。

18: TCB 的作用是什么？
答：客户进程和服务器进程通信之前首先都需要创建各自的 TCB(传输控制模块)，TCB 中存储了每一个连接中的一些重要信息，如：TCP 连接表、指向发送和接收缓存的指针、指向重传队列的指针、当前的发送序号和接收序号等。TCB 是控制 TCP 连接的核心模块。

19: TCP 建立连接三次握手流程？
答：客户端A，服务器端B。A 首先给 B 发送连接请求报文段，首部中 SYN 字段为1，ACK 字段为 0，同时选择一个初始序号 seq = x。
B 收到请求报文后如果同意则向 A 发送确认，在确认报文中 确认号 ack = x+1, 同时为自己选择一个初始序号 seq = y。
A 收到 B 的确认报文后，需要给 B 发一个确认报文，首部中 ACK 字段为1，ack = y+1,seq=x+1。

20: TCP 释放连接四次挥手流程？
答：客户端A，服务器端B。A 首先给 B 发送连接释放报文段，首部中 FIN 字段为1，ACK 字段为 0，同时序号 seq = u(u 为前面已传送过的数据的最后一个字节序号加一)，此时 A 进入 FIN－WAIT1 状态。
B 收到请求报文后向 A 发送确认，在确认报文中 确认号 ack = u+1, 同时序号 seq = v(和 u 同理)，B 进入 CLOSE-WAIT 状态。
A 收到 B 的确认报文后，进入 FIN－WAIT2 状态。此时 B 仍可以给 A 发数据。
若 B 已经没有数据要发给 A，则应用进程通知 TCB 释放连接，这是 B 发出的连接释放报文 FIN ＝ 1，假定此时 B 序号 seq ＝ w(半关闭期间 B 可能给 A 发数据)，ack = u+1, 此时 B 进入 LAST－ACK 状态。
最后 A 给出确认报文，ACK为1，ack ＝ w+1，seq ＝ u+1。B 收到 A 的确认后撤销相应的 TCB 后关闭 TCP 连接，而 A 则需要等待一个 2MSL 时间后关闭。

21: TCP Select 模型
将所有的socket(服务器端+客户端)装进一个数组中
通过select()遍历socket数组
取出有响应的socket放进另一个数组（都是有响应的socket）
对装有响应的socket数组集中处理
服务器socket响应：客户端链接，调用accept()
客户端socket响应：客户端通信，调用send()或recv()
TCP 面向字节流，所以在 recv 函数中接受到的数据可能只是当前数据报的一部分，所以需要有一个数据包传输结束的标识，或者有数据报大小的字段可供参考。
🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥
第六章  应用层
1: 什么是域名系统 DNS？起什么作用？
答：用来便于人们使用的机器名字转换为 IP 地址的系统。域名解析成 IP 地址的系统。

2: 根域名服务器和顶级域名服务器？
答：根DNS全球共13个，a.rootservers.net~m.rootservers.net; 顶级DNS分成，国家级(cn,us,uk)、通用顶级(com,net,edu)、基础结构域名(arpa)三大类。

3: 互联网的域名空间分布以及域名的组成结构？
答：互联网的域名空间分布成树状，根节点为根域名，其下分别是顶级域名、二级域名、三级域名...。
每个域名组成是由名字和点构成，mail.cctv.com, 顶级域名在最右边。

4: 域名的解析过程？
答：主机先在本地的域名服务器查询该 IP，如果没查询到则本地域名服务器以 DNS 客户的身份，向其他根域名服务器发出查询请求报文，而不是让主机自己查询，这种方式称为递归查询。当根域名服务器收到的是本地域名服务器的迭代查询请求报文时，则要么返回目标 IP，要么返回下一步应该请求哪个域名服务器。

5: 文件传输协议 FTP 和 TFTP 的区别？以及各自的工作原理？
答：FTP 基于 TCP，TFTP 基于 UDP。FTP 采用客户／服务器模式，FTP 客户端和服务器端都需要一个控制进程和一个数据传送进程，当客户进程需要向服务器发送文件时，首先和服务器的端口21建立 TCP 控制连接（FTP服务器始终监听21端口），并将自身的数据传输端口发给服务器，然后服务器20端口主动和客户端数据传输端口建立数据传送 TCP 连接。一个FTP服务器可能同时处理多个客户请求，所以 FTP 服务器分成主进程和从属进程两大部分。主进程负责接受进的请求，若干个从属进程负责处理单个请求。
TFTP 使用 UDP 数据报进行传输，但是有自身的差错检测措施，对每个数据报按序编号，工作类似于停止等待协议 ARQ，每次发完一个报文都需要等待确认以保证数据可靠传输。

6: TELNET 工作原理？
答：TELNET 允许用户远程登录一台主机上，并进行交互。TELNET 服务器类似于 FTP 也分成主进程和从属进程两大部分。其工作基于 TCP，需要和主机建立 TCP 连接，然后再使用 NVT 格式进行交互。

7: HTTP 工作流程？
答：首先需要建立 TCP 连接，在 TCP 的第三次握手报文中，浏览器将 HTTP 请求数据装在报文的数据部分，服务器收到后给出 HTTP 应答数据。HTTP/1.0 使用的是非持续连接方式，每次都需要重新建立 TCP 连接。而HTTP/1.1 则支持持续连接方式，即 TCP 连接会保持一段时间，节省下次请求的一次往返 RTT。
PS：URL格式为 http(s)://<主机>:<端口>/<路径>，http端口默认为80

8: 代理服务器的作用以及工作流程？
答：使用代理服务器可以减少互联网的时延。再请求服务时，如果有代理服务器则先和代理服务器建立 TCP 连接，若代理服务器中已经存在所请求的对象，则直接返回数据，否则代理服务器以客户的身份和源点服务器建立 TCP 连接，并发送请求报文。源点服务器返回给代理服务器数据后，代理服务器先将数据缓存，然后再返给客户端。

9: 网站 Cookie 的作用流程和作用？
答：A 访问 购物网站 B。B 给 A 生成一个唯一的识别码，并以这个识别码再后端数据库中产生一个项目，并且将这个 Cookie 返回给 A 的 HTTP 响应报文中。当 A收到响应报文后，浏览器会识别出来 "set-cookie" 头部，并且将这个 Cookie 保存起来，当 A 再次访问 B 及其子页面时，浏览器会自动带上 Cookie。这样浏览器就可以识别出 A 来访问了，可以根据 A 的购买记录推荐商品。

10: DHCP 协议的作用以及工作流程？
答：DHCP 动态主机配置协议，可以动态的为主机分配IP地址、子网掩码、默认路由IP等连接网络所需的配置。需要 IP 地址的主机启动时便发送一个广播报文，DHCP 服务器收到后给其响应，主机向该 DHCP 服务器发送请求报文，DHCP 服务器同意后给其返回相关的配置信息(主要是 IP 地址)。

11: 一个TCP服务器怎样实现同时和多个客户端建立 TCP 连接？
答：当主服务器收到客户端的 connect 请求后，会系统调用 accept，以把客户进程发来的连接请求提取出来，同时为这个连接请求创建一个新的套接字，以及一个从属服务器进程，从属服务器进程负责这次连接以及数据传输，而主服务器进程则继续重新调用 accept 继续接受下一次连接请求。







